<!--
환경 / 실행 정보
- 환경: HTML5 + CSS3 + Vanilla JavaScript(ES6)
- 의존성: 외부 라이브러리 없음 (인터넷 연결 필요 없음)
- 실행 방법:
  1) 이 파일을 index.html 이름으로 저장
  2) 크롬/엣지/사파리 등 브라우저로 열기 (더블 클릭 또는 드래그)

기능 요약
- 역할 구분: 일반 케어 서포터(무자격) / 전문 요양보호사(자격증)
- 일반인: 시급 + 봉사시간 제공 여부 필드
- 요양보호사: 고급인력으로 표시
- 인력 프로필 등록: 사용자 입력을 메모리 배열에 저장
- 매칭 검색: 지역 / 필요 인력 유형 / 최소 시급 / 봉사시간 여부 기준으로 필터링
- 입력 검증: 필수값, 시급 숫자/양수 체크
- 테스트: matchCaregivers 함수에 대해 3개 이상 테스트 케이스 제공 (콘솔에서 확인)

설계 개요
- 자료구조:
  caregivers: [
    {
      id: number,
      name: string,
      type: 'general' | 'pro',
      region: string,
      hourlyRate: number,
      providesVolunteer: boolean,
      hasCertificate: boolean
    }
  ]

- 주요 함수:
  addCaregiver(profile): 입력 검증 후 caregivers 배열에 추가
  validateCaregiverProfile(profile): 잘못된 입력이면 에러 메시지 문자열 반환
  matchCaregivers(criteria): caregivers 배열을 필터링해 조건에 맞는 인력 목록 반환
  renderCaregivers(list, targetElement): DOM에 카드 형태로 렌더링
  runTests(): matchCaregivers 로직 테스트 (콘솔 출력)

- 시간 복잡도:
  - matchCaregivers: O(n) (caregivers 전체를 한 번 순회)
  - 현재 규모의 지역 서비스(수천 명 수준)에서는 충분히 빠름
  - 추후 대규모 서비스 시 서버/DB + 인덱싱 필요

-->

<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>실버케어 매칭 플랫폼 MVP</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f4f5f7;
      color: #222;
      padding: 16px;
    }
    .app-container {
      max-width: 960px;
      margin: 0 auto;
      background: #fff;
      border-radius: 16px;
      padding: 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.06);
    }
    h1 {
      font-size: 22px;
      margin-bottom: 4px;
    }
    .subtitle {
      font-size: 13px;
      color: #666;
      margin-bottom: 16px;
    }
    .tab-bar {
      display: flex;
      border-radius: 999px;
      background: #f0f1f5;
      padding: 4px;
      margin-bottom: 16px;
    }
    .tab {
      flex: 1;
      text-align: center;
      padding: 10px 0;
      border-radius: 999px;
      font-size: 14px;
      cursor: pointer;
      border: none;
      background: transparent;
      transition: background 0.2s, color 0.2s;
    }
    .tab.active {
      background: #3269ff;
      color: #fff;
      font-weight: 600;
    }
    .section {
      margin-bottom: 24px;
    }
    .section-title {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 8px;
    }
    .section-description {
      font-size: 13px;
      color: #555;
      margin-bottom: 10px;
    }
    form {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 10px 16px;
      margin-bottom: 12px;
    }
    label {
      font-size: 13px;
      margin-bottom: 4px;
      display: block;
      font-weight: 500;
    }
    input[type="text"],
    input[type="number"],
    select {
      width: 100%;
      padding: 8px 10px;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 13px;
    }
    input[type="checkbox"] {
      margin-right: 6px;
    }
    .checkbox-row {
      display: flex;
      align-items: center;
      font-size: 13px;
    }
    .btn {
      padding: 9px 14px;
      border-radius: 999px;
      border: none;
      font-size: 13px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      white-space: nowrap;
    }
    .btn-primary {
      background: #3269ff;
      color: #fff;
    }
    .btn-secondary {
      background: #e3e5ec;
      color: #333;
    }
    .btn-small {
      padding: 5px 10px;
      font-size: 11px;
    }
    .inline-buttons {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }
    .error-message {
      font-size: 12px;
      color: #c53030;
      margin-bottom: 8px;
    }
    .success-message {
      font-size: 12px;
      color: #057a55;
      margin-bottom: 8px;
    }
    .card-list {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(230px, 1fr));
      gap: 12px;
    }
    .card {
      border-radius: 12px;
      border: 1px solid #e1e4ea;
      padding: 10px 12px;
      background: #fafbff;
      font-size: 13px;
    }
    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 4px;
    }
    .badge {
      font-size: 11px;
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid #ccc;
    }
    .badge-general {
      border-color: #7c3aed;
      color: #7c3aed;
      background: #f5f3ff;
    }
    .badge-pro {
      border-color: #1d4ed8;
      color: #1d4ed8;
      background: #eff6ff;
    }
    .badge-volunteer {
      border-color: #059669;
      color: #047857;
      background: #ecfdf5;
      margin-left: 4px;
    }
    .card-row {
      margin-bottom: 2px;
    }
    .empty-state {
      font-size: 13px;
      color: #777;
      padding: 8px;
      border-radius: 8px;
      border: 1px dashed #cbd2e1;
      background: #f9fafb;
    }
    .hidden {
      display: none;
    }

    @media (max-width: 600px) {
      .app-container {
        padding: 16px 12px;
        border-radius: 12px;
      }
    }
  </style>
</head>
<body>
  <div class="app-container">
    <h1>실버케어 인력 매칭 플랫폼 (MVP)</h1>
    <div class="subtitle">
      일반인 알바·봉사 인력과 자격증 보유 요양보호사를<br />
      요양원·가정 보호자가 쉽게 찾을 수 있게 도와주는 웹 기반 앱입니다.
    </div>

    <!-- 탭 -->
    <div class="tab-bar">
      <button class="tab active" id="tab-matching">매칭 찾기 (요양원·보호자)</button>
      <button class="tab" id="tab-profile">인력 프로필 등록 (일반·요양보호사)</button>
    </div>

    <!-- 매칭 찾기 섹션 -->
    <div id="section-matching" class="section">
      <div class="section-title">조건에 맞는 인력 찾기</div>
      <div class="section-description">
        요양원, 복지관, 혹은 가정 보호자가 사용할 화면입니다. 필요한 조건을 넣고 "매칭 검색"을 눌러보세요.
      </div>

      <div id="matching-error" class="error-message hidden"></div>
      <form id="matching-form">
        <div>
          <label for="match-region">지역 (예: 춘천시, 강원대 인근 등)</label>
          <input type="text" id="match-region" placeholder="예: 춘천시" />
        </div>
        <div>
          <label for="match-type">필요 인력 유형</label>
          <select id="match-type">
            <option value="any">무관 (일반 + 전문 모두)</option>
            <option value="general">일반 케어 서포터 (무자격)</option>
            <option value="pro">전문 요양보호사 (자격증 보유)</option>
          </select>
        </div>
        <div>
          <label for="match-min-hourly">최소 시급 (원)</label>
          <input type="number" id="match-min-hourly" placeholder="예: 12000" min="0" />
        </div>
        <div class="checkbox-row">
          <input type="checkbox" id="match-needs-volunteer" />
          <label for="match-needs-volunteer">봉사시간 인증 가능한 인력만 보기</label>
        </div>
      </form>
      <div class="inline-buttons" style="margin-bottom: 10px;">
        <button class="btn btn-primary" id="btn-search">매칭 검색</button>
        <button class="btn btn-secondary btn-small" id="btn-reset-matching">조건 초기화</button>
      </div>

      <div class="section-title" style="margin-top: 8px;">검색 결과</div>
      <div id="matching-results" class="card-list"></div>
      <div id="matching-empty" class="empty-state hidden">
        아직 등록된 인력이 없거나, 조건에 맞는 인력이 없습니다.<br />
        우측 탭에서 인력 프로필을 먼저 등록해 보세요.
      </div>
    </div>

    <!-- 인력 프로필 등록 섹션 -->
    <div id="section-profile" class="section hidden">
      <div class="section-title">인력 프로필 등록</div>
      <div class="section-description">
        일반인 알바·봉사 인력 또는 자격증 보유 요양보호사 분들이 자신의 프로필을 등록하는 화면입니다.
      </div>

      <div id="profile-error" class="error-message hidden"></div>
      <div id="profile-success" class="success-message hidden"></div>

      <form id="profile-form">
        <div>
          <label for="caregiver-name">이름</label>
          <input type="text" id="caregiver-name" placeholder="이름 입력" />
        </div>
        <div>
          <label for="caregiver-region">활동 지역</label>
          <input type="text" id="caregiver-region" placeholder="예: 춘천시, 강원대 인근" />
        </div>
        <div>
          <label for="caregiver-type">인력 유형</label>
          <select id="caregiver-type">
            <option value="general">일반 케어 서포터 (무자격, 알바/봉사)</option>
            <option value="pro">전문 요양보호사 (자격증 보유)</option>
          </select>
        </div>
        <div>
          <label for="caregiver-hourly">희망 시급 (원)</label>
          <input type="number" id="caregiver-hourly" placeholder="예: 12000" min="0" />
        </div>
        <div class="checkbox-row">
          <input type="checkbox" id="caregiver-volunteer" />
          <label for="caregiver-volunteer">봉사시간 인증 제공 가능</label>
        </div>
        <div class="checkbox-row">
          <input type="checkbox" id="caregiver-certificate" />
          <label for="caregiver-certificate">요양보호사 자격증 보유</label>
        </div>
      </form>
      <div class="inline-buttons">
        <button class="btn btn-primary" id="btn-add-caregiver">프로필 등록</button>
        <button class="btn btn-secondary btn-small" id="btn-reset-profile">입력 초기화</button>
        <button class="btn btn-secondary btn-small" id="btn-run-tests">테스트 실행 (콘솔)</button>
      </div>

      <div class="section-title" style="margin-top: 16px;">등록된 인력 목록</div>
      <div id="caregiver-list" class="card-list"></div>
      <div id="caregiver-empty" class="empty-state">
        아직 등록된 인력이 없습니다. 상단 폼에서 첫 번째 인력을 등록해 보세요.
      </div>
    </div>
  </div>

  <script>
    // -------------------------------
    // 전역 상태 (메모리 DB 역할)
    // -------------------------------
    const caregivers = [];
    let caregiverIdSeq = 1;

    // 초기 더미 데이터 (테스트용)
    caregivers.push(
      {
        id: caregiverIdSeq++,
        name: '김일반',
        type: 'general',
        region: '춘천시',
        hourlyRate: 12000,
        providesVolunteer: true,
        hasCertificate: false
      },
      {
        id: caregiverIdSeq++,
        name: '이전문',
        type: 'pro',
        region: '춘천시 강원대 인근',
        hourlyRate: 15000,
        providesVolunteer: false,
        hasCertificate: true
      },
      {
        id: caregiverIdSeq++,
        name: '박서포터',
        type: 'general',
        region: '서울 강동구',
        hourlyRate: 11000,
        providesVolunteer: false,
        hasCertificate: false
      }
    );

    // -------------------------------
    // DOM 요소 캐싱
    // -------------------------------
    const tabMatching = document.getElementById('tab-matching');
    const tabProfile = document.getElementById('tab-profile');
    const sectionMatching = document.getElementById('section-matching');
    const sectionProfile = document.getElementById('section-profile');

    const matchingForm = document.getElementById('matching-form');
    const matchingError = document.getElementById('matching-error');
    const matchingResults = document.getElementById('matching-results');
    const matchingEmpty = document.getElementById('matching-empty');

    const profileForm = document.getElementById('profile-form');
    const profileError = document.getElementById('profile-error');
    const profileSuccess = document.getElementById('profile-success');
    const caregiverList = document.getElementById('caregiver-list');
    const caregiverEmpty = document.getElementById('caregiver-empty');

    const btnSearch = document.getElementById('btn-search');
    const btnResetMatching = document.getElementById('btn-reset-matching');
    const btnAddCaregiver = document.getElementById('btn-add-caregiver');
    const btnResetProfile = document.getElementById('btn-reset-profile');
    const btnRunTests = document.getElementById('btn-run-tests');

    // -------------------------------
    // UI 전환 함수
    // -------------------------------
    function switchTab(tab) {
      if (tab === 'matching') {
        tabMatching.classList.add('active');
        tabProfile.classList.remove('active');
        sectionMatching.classList.remove('hidden');
        sectionProfile.classList.add('hidden');
      } else {
        tabMatching.classList.remove('active');
        tabProfile.classList.add('active');
        sectionMatching.classList.add('hidden');
        sectionProfile.classList.remove('hidden');
      }
    }

    tabMatching.addEventListener('click', () => switchTab('matching'));
    tabProfile.addEventListener('click', () => switchTab('profile'));

    // -------------------------------
    // 검증 함수
    // -------------------------------
    function validateCaregiverProfile(profile) {
      if (!profile.name || profile.name.trim().length === 0) {
        return '이름을 입력해 주세요.';
      }
      if (!profile.region || profile.region.trim().length === 0) {
        return '활동 지역을 입력해 주세요.';
      }
      if (profile.hourlyRate === '' || profile.hourlyRate === null || isNaN(profile.hourlyRate)) {
        return '희망 시급을 숫자로 입력해 주세요.';
      }
      if (profile.hourlyRate < 0) {
        return '희망 시급은 0원 이상이어야 합니다.';
      }
      if (!['general', 'pro'].includes(profile.type)) {
        return '인력 유형이 올바르지 않습니다.';
      }
      return null; // 에러 없음
    }

    function validateMatchingCriteria(criteria) {
      if (criteria.minHourly !== '' && (isNaN(criteria.minHourly) || criteria.minHourly < 0)) {
        return '최소 시급은 0원 이상 숫자로 입력해 주세요.';
      }
      if (!['any', 'general', 'pro'].includes(criteria.type)) {
        return '필요 인력 유형이 올바르지 않습니다.';
      }
      return null;
    }

    // -------------------------------
    // 데이터 추가 및 매칭 로직
    // -------------------------------
    function addCaregiver(profile) {
      const error = validateCaregiverProfile(profile);
      if (error) {
        throw new Error(error);
      }
      const newCaregiver = {
        id: caregiverIdSeq++,
        ...profile
      };
      caregivers.push(newCaregiver);
      return newCaregiver;
    }

    /**
     * 매칭 함수
     * @param {Object} criteria
     * @param {string} criteria.region - 검색 지역 (부분 문자열 포함 허용, 없으면 전체)
     * @param {string} criteria.type - 'any' | 'general' | 'pro'
     * @param {number|''} criteria.minHourly - 최소 시급
     * @param {boolean} criteria.needsVolunteer - 봉사시간 가능한 인력만
     * @returns {Array}
     */
    function matchCaregivers(criteria) {
      const error = validateMatchingCriteria(criteria);
      if (error) {
        throw new Error(error);
      }

      const regionKeyword = criteria.region ? criteria.region.trim() : '';

      return caregivers.filter(cg => {
        // 인력 유형 필터
        if (criteria.type !== 'any' && cg.type !== criteria.type) {
          return false;
        }
        // 지역 필터 (부분 일치, 대소문자 무시)
        if (regionKeyword.length > 0) {
          const cgRegion = cg.region.toLowerCase();
          if (!cgRegion.includes(regionKeyword.toLowerCase())) {
            return false;
          }
        }
        // 시급 필터
        if (criteria.minHourly !== '' && criteria.minHourly !== null) {
          if (cg.hourlyRate < criteria.minHourly) {
            return false;
          }
        }
        // 봉사시간 필터
        if (criteria.needsVolunteer && !cg.providesVolunteer) {
          return false;
        }

        return true;
      });
    }

    // -------------------------------
    // 렌더링 함수
    // -------------------------------
    function renderCaregivers(list, targetElement, emptyElement) {
      targetElement.innerHTML = '';
      if (!list || list.length === 0) {
        if (emptyElement) emptyElement.classList.remove('hidden');
        return;
      }
      if (emptyElement) emptyElement.classList.add('hidden');

      list.forEach(cg => {
        const card = document.createElement('div');
        card.className = 'card';

        const header = document.createElement('div');
        header.className = 'card-header';

        const nameSpan = document.createElement('span');
        nameSpan.textContent = cg.name;

        const badgeSpan = document.createElement('span');
        const typeBadge = document.createElement('span');
        typeBadge.className = 'badge ' + (cg.type === 'pro' ? 'badge-pro' : 'badge-general');
        typeBadge.textContent = cg.type === 'pro' ? '전문 요양보호사' : '일반 케어 서포터';

        badgeSpan.appendChild(typeBadge);

        if (cg.providesVolunteer) {
          const volBadge = document.createElement('span');
          volBadge.className = 'badge badge-volunteer';
          volBadge.textContent = '봉사시간 인증 가능';
          badgeSpan.appendChild(volBadge);
        }

        header.appendChild(nameSpan);
        header.appendChild(badgeSpan);
        card.appendChild(header);

        const rowRegion = document.createElement('div');
        rowRegion.className = 'card-row';
        rowRegion.textContent = '지역: ' + cg.region;
        card.appendChild(rowRegion);

        const rowHourly = document.createElement('div');
        rowHourly.className = 'card-row';
        rowHourly.textContent = '희망 시급: ' + cg.hourlyRate.toLocaleString('ko-KR') + '원';
        card.appendChild(rowHourly);

        if (cg.hasCertificate) {
          const rowCert = document.createElement('div');
          rowCert.className = 'card-row';
          rowCert.textContent = '자격증: 요양보호사 보유';
          card.appendChild(rowCert);
        }

        targetElement.appendChild(card);
      });
    }

    // -------------------------------
    // 이벤트 핸들러 설정
    // -------------------------------
    function clearProfileMessages() {
      profileError.classList.add('hidden');
      profileSuccess.classList.add('hidden');
    }

    function clearMatchingMessages() {
      matchingError.classList.add('hidden');
    }

    btnAddCaregiver.addEventListener('click', () => {
      clearProfileMessages();
      const name = document.getElementById('caregiver-name').value;
      const region = document.getElementById('caregiver-region').value;
      const type = document.getElementById('caregiver-type').value;
      const hourlyValue = document.getElementById('caregiver-hourly').value;
      const providesVolunteer = document.getElementById('caregiver-volunteer').checked;
      const hasCertificate = document.getElementById('caregiver-certificate').checked;

      const hourlyRate = hourlyValue === '' ? '' : Number(hourlyValue);

      const profile = {
        name,
        region,
        type,
        hourlyRate,
        providesVolunteer,
        hasCertificate
      };

      try {
        const added = addCaregiver(profile);
        profileSuccess.textContent = `"${added.name}" 인력이 성공적으로 등록되었습니다.`;
        profileSuccess.classList.remove('hidden');
        renderCaregivers(caregivers, caregiverList, caregiverEmpty);
        profileForm.reset();
      } catch (e) {
        profileError.textContent = e.message;
        profileError.classList.remove('hidden');
      }
    });

    btnResetProfile.addEventListener('click', () => {
      profileForm.reset();
      clearProfileMessages();
    });

    btnSearch.addEventListener('click', () => {
      clearMatchingMessages();
      const region = document.getElementById('match-region').value;
      const type = document.getElementById('match-type').value;
      const minHourlyValue = document.getElementById('match-min-hourly').value;
      const needsVolunteer = document.getElementById('match-needs-volunteer').checked;

      const criteria = {
        region,
        type,
        minHourly: minHourlyValue === '' ? '' : Number(minHourlyValue),
        needsVolunteer
      };

      try {
        const results = matchCaregivers(criteria);
        renderCaregivers(results, matchingResults, matchingEmpty);
      } catch (e) {
        matchingError.textContent = e.message;
        matchingError.classList.remove('hidden');
        matchingResults.innerHTML = '';
        matchingEmpty.classList.remove('hidden');
      }
    });

    btnResetMatching.addEventListener('click', () => {
      matchingForm.reset();
      clearMatchingMessages();
      matchingResults.innerHTML = '';
      // 조건 초기화 상태에서 전체 인력 보여주도록 할 수도 있음
      matchingEmpty.classList.remove('hidden');
    });

    // -------------------------------
    // 테스트 함수
    // -------------------------------
    function runTests() {
      console.log('--- matchCaregivers 테스트 시작 ---');

      // 테스트 1: 특정 지역 + 유형 필터
      const criteria1 = {
        region: '춘천시',
        type: 'general',
        minHourly: '',
        needsVolunteer: false
      };
      const result1 = matchCaregivers(criteria1);
      console.assert(
        result1.length === 1 && result1[0].name === '김일반',
        '테스트 1 실패: 춘천시 일반 인력 매칭 오류',
        result1
      );
      console.log('테스트 1 통과:', result1.map(c => c.name));

      // 테스트 2: 최소 시급 필터 (15000 이상 전문)
      const criteria2 = {
        region: '',
        type: 'pro',
        minHourly: 15000,
        needsVolunteer: false
      };
      const result2 = matchCaregivers(criteria2);
      console.assert(
        result2.length >= 1 && result2.some(c => c.name === '이전문'),
        '테스트 2 실패: 전문 인력 시급 필터 오류',
        result2
      );
      console.log('테스트 2 통과:', result2.map(c => c.name));

      // 테스트 3: 봉사시간 제공 인력 필터
      const criteria3 = {
        region: '',
        type: 'any',
        minHourly: '',
        needsVolunteer: true
      };
      const result3 = matchCaregivers(criteria3);
      console.assert(
        result3.length >= 1 && result3.some(c => c.providesVolunteer),
        '테스트 3 실패: 봉사시간 인력 필터 오류',
        result3
      );
      console.log('테스트 3 통과:', result3.map(c => c.name));

      // 테스트 4: 잘못된 시급 입력 검증
      let errorCaught = false;
      try {
        matchCaregivers({
          region: '',
          type: 'any',
          minHourly: -100,
          needsVolunteer: false
        });
      } catch (e) {
        errorCaught = true;
        console.log('테스트 4 통과: 잘못된 시급 검증 에러 정상 발생 -', e.message);
      }
      console.assert(errorCaught, '테스트 4 실패: 음수 시급 검증이 동작하지 않음');

      console.log('--- 테스트 종료 ---');
    }

    btnRunTests.addEventListener('click', runTests);

    // 초기 렌더링
    renderCaregivers(caregivers, caregiverList, caregiverEmpty);
    matchingEmpty.classList.remove('hidden');
  </script>
</body>
</html>
